<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Create FFI structure type — ffi_struct • RSimpleFFI</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Create FFI structure type — ffi_struct"><meta name="description" content="Creates an FFI structure type from named field types. By default, libffi
uses natural alignment (each field aligned to its size). Use the .pack
parameter to specify tighter packing similar to #pragma pack(n) in C."><meta property="og:description" content="Creates an FFI structure type from named field types. By default, libffi
uses natural alignment (each field aligned to its size). Use the .pack
parameter to specify tighter packing similar to #pragma pack(n) in C."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">RSimpleFFI</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.0.90000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/sounkou-bioinfo/RSimpleFFI/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Create FFI structure type</h1>
      <small class="dont-index">Source: <a href="https://github.com/sounkou-bioinfo/RSimpleFFI/blob/main/R/00-types.R" class="external-link"><code>R/00-types.R</code></a></small>
      <div class="d-none name"><code>ffi_struct.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Creates an FFI structure type from named field types. By default, libffi
uses natural alignment (each field aligned to its size). Use the <code>.pack</code>
parameter to specify tighter packing similar to <code>#pragma pack(n)</code> in C.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ffi_struct</span><span class="op">(</span><span class="va">...</span>, .pack <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Named FFIType objects representing struct fields</p></dd>


<dt id="arg--pack">.pack<a class="anchor" aria-label="anchor" href="#arg--pack"></a></dt>
<dd><p>Integer specifying packing alignment (1, 2, 4, 8, or 16), or NULL
for default/natural alignment. When .pack=1, fields are byte-aligned (no padding).
The dot prefix prevents collision with C struct field names.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>StructType object</p>
    </div>
    <div class="section level2">
    <h2 id="packing">Packing<a class="anchor" aria-label="anchor" href="#packing"></a></h2>


<p>The <code>.pack</code> parameter affects <code><a href="ffi_offsetof.html">ffi_offsetof()</a></code>, <code><a href="ffi_sizeof.html">ffi_sizeof()</a></code>,
<code><a href="ffi_get_field.html">ffi_get_field()</a></code>, and <code><a href="ffi_set_field.html">ffi_set_field()</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="packed-structs-by-value">Packed Structs By Value<a class="anchor" aria-label="anchor" href="#packed-structs-by-value"></a></h2>


<p>Packed structs cannot be passed by value - GCC compiles functions taking
<code>__attribute__((packed))</code> structs to expect arguments on the stack, but
libffi passes via registers. Use pointers instead.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Natural alignment (default)</span></span></span>
<span class="r-in"><span><span class="va">Point</span> <span class="op">&lt;-</span> <span class="fu">ffi_struct</span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="ffi_int.html">ffi_int</a></span><span class="op">(</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="ffi_int.html">ffi_int</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Packed struct (1-byte alignment)</span></span></span>
<span class="r-in"><span><span class="va">PackedData</span> <span class="op">&lt;-</span> <span class="fu">ffi_struct</span><span class="op">(</span></span></span>
<span class="r-in"><span>  flag <span class="op">=</span> <span class="fu"><a href="ffi_uint8.html">ffi_uint8</a></span><span class="op">(</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  value <span class="op">=</span> <span class="fu"><a href="ffi_int32.html">ffi_int32</a></span><span class="op">(</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  .pack <span class="op">=</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Check sizes</span></span></span>
<span class="r-in"><span><span class="fu"><a href="ffi_sizeof.html">ffi_sizeof</a></span><span class="op">(</span><span class="va">Point</span><span class="op">)</span> <span class="co"># Natural size</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 8</span>
<span class="r-in"><span><span class="fu"><a href="ffi_sizeof.html">ffi_sizeof</a></span><span class="op">(</span><span class="va">PackedData</span><span class="op">)</span> <span class="co"># Packed size (smaller)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 5</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Note: Packed structs cannot be passed by value to C functions.</span></span></span>
<span class="r-in"><span><span class="co"># Use pointers instead:</span></span></span>
<span class="r-in"><span><span class="co"># ffi_function("some_func", ffi_void(), ffi_pointer())</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Sounkou Mahamane Toure.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

